---
- hosts: ivre
  tasks:
  # https://github.com/cea-sec/ivre/blob/master/doc/FAST-INSTALL-AND-FIRST-RUN.md
  - name: Install IVRE dependencies
    apt:
      name: "{{ item }}"
      state: latest
    with_items:
      - 'git'
      - 'mongodb'
      - 'python-pymongo'
      - 'python-crypto'
      - 'apache2'
      - 'dokuwiki'
      - 'python3-pip'

  - name: Update pip
    pip:
      name: pip
      state: latest

  - name: Clone ivre
    git:
      repo: 'https://github.com/cea-sec/ivre'
      dest: /root/ivre
      update: yes
      clone: yes

  - name: cd ivre
    shell: |
      cd ivre
      chmod +x setup.py

  - name: setup.py build
    shell: |
      cd ivre
      setup.py build

  - name: setup.py install
    shell: |
      cd ivre
      setup.py install


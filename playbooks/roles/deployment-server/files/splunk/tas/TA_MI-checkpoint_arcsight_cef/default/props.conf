##########################################################
# Generic Checkpoint data from ArcSight - presourcetyping
##########################################################
[checkpoint:arcsight:cef]
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 5000
TIME_PREFIX = \s(end|rt)\=
TIME_FORMAT = %s%3N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = none
SHOULD_LINEMERGE = false
NO_BINARY_CHECK = 1

# rewrite sourcetypes for the Checkpoint CEF data
TRANSFORMS-force_sourcetype_cp_arcsight_firewall = sourcetype_for_checkpoint_arcsight_cef_firewall
TRANSFORMS-force_sourcetype_cp_arcsight_smartdefense = sourcetype_for_checkpoint_arcsight_cef_smartdefense
TRANSFORMS-force_sourcetype_cp_arcsight_urlfiltering = sourcetype_for_checkpoint_arcsight_cef_urlfiltering
TRANSFORMS-force_sourcetype_cp_arcsight_appcontrol = sourcetype_for_checkpoint_arcsight_cef_appcontrol
TRANSFORMS-force_sourcetype_cp_arcsight_identity = sourcetype_for_checkpoint_arcsight_cef_identity
TRANSFORMS-force_sourcetype_cp_arcsight_antivirus = sourcetype_for_checkpoint_arcsight_cef_antivirus
TRANSFORMS-force_sourcetype_cp_arcsight_antimalware = sourcetype_for_checkpoint_arcsight_cef_antimalware

#####################################################
# Checkpoint Firewall from ArcSight
#####################################################
[checkpoint:arcsight:cef:firewall]
# disable auto KV
KV_MODE = none

# CEF extractions for Checkpoint events
REPORT-00checkpoint_cefHeaders = checkpoint_arcsight_cefHeaders
REPORT-00checkpoint_cefKeys = checkpoint_arcsight_cefKeys

####
#### CIM field mappings common for Checkpoint CEF
####
FIELDALIAS-dest_ip_for_checkpoint = dst as dest_ip
FIELDALIAS-src_ip_for_checkpoint = src as src_ip
FIELDALIAS-dest_port_for_checkpoint = dpt AS dest_port
FIELDALIAS-src_port_for_checkpoint = spt AS src_port
FIELDALIAS-vendor_action = act as vendor_action
FIELDALIAS-vendor = cef_vendor as vendor
FIELDALIAS-product = cef_product as product
EVAL-dvc = coalesce(dvchost,dvc)
EVAL-transport = lower(proto)
EVAL-vendor_product = cef_vendor." ".cef_product

# Bytes transferred
FIELDALIAS-in = in as bytes_in
FIELDALIAS-out = out as bytes_out
EVAL-bytes = if(cs5Label=="Total bytes",cs5,null)

REPORT-user_for_checkpoint_arcsight_cef = duser_as_user_for_checkpoint_arcsight_cef

# get the action for Checkpoint ArcSight CEF
LOOKUP-action_for_checkpoint_syslog = checkpoint_arcsight_cef_action_lookup vendor_action OUTPUT action
LOOKUP-severity_for_checkpoint_syslog = checkpoint_arcsight_cef_severity_lookup deviceSeverity OUTPUT severity

####
#### Checkpoint ArcSight firewall specific extractions
####
FIELDALIAS-dest = dst AS dest
FIELDALIAS-service = destinationServiceName as app

#####################################################
# Checkpoint SmartDefense from ArcSight
#####################################################
[checkpoint:arcsight:cef:smartdefense]
# disable auto KV
KV_MODE = none

# CEF extractions for Checkpoint events
REPORT-00checkpoint_cefHeaders = checkpoint_arcsight_cefHeaders
REPORT-00checkpoint_cefKeys = checkpoint_arcsight_cefKeys

####
#### CIM field mappings common for Checkpoint CEF
####
FIELDALIAS-dest_ip_for_checkpoint = dst as dest_ip
FIELDALIAS-src_ip_for_checkpoint = src as src_ip
FIELDALIAS-dest_port_for_checkpoint = dpt AS dest_port
FIELDALIAS-src_port_for_checkpoint = spt AS src_port
FIELDALIAS-vendor_action = act as vendor_action
FIELDALIAS-vendor = cef_vendor as vendor
FIELDALIAS-product = cef_product as product
EVAL-dvc = coalesce(dvchost,dvc)
EVAL-transport = lower(proto)
EVAL-vendor_product = cef_vendor." ".cef_product

# Bytes transferred
FIELDALIAS-in = in as bytes_in
FIELDALIAS-out = out as bytes_out
EVAL-bytes = if(cs5Label=="Total bytes",cs5,null)

REPORT-user_for_checkpoint_arcsight_cef = duser_as_user_for_checkpoint_arcsight_cef

# get the action for Checkpoint ArcSight CEF
LOOKUP-action_for_checkpoint_syslog = checkpoint_arcsight_cef_action_lookup vendor_action OUTPUT action
LOOKUP-severity_for_checkpoint_syslog = checkpoint_arcsight_cef_severity_lookup deviceSeverity OUTPUT severity

####
#### Checkpoint ArcSight SmartDefense specific extractions
####
FIELDALIAS-category = cef_signature AS category
FIELDALIAS-signature = msg AS signature
EVAL-ids_type = "network"

#####################################################
# Checkpoint URL Filtering from ArcSight
#####################################################
[checkpoint:arcsight:cef:url]
# disable auto KV
KV_MODE = none

# CEF extractions for Checkpoint events
REPORT-00checkpoint_cefHeaders = checkpoint_arcsight_cefHeaders
REPORT-00checkpoint_cefKeys = checkpoint_arcsight_cefKeys

####
#### CIM field mappings common for Checkpoint CEF
####
FIELDALIAS-dest_ip_for_checkpoint = dst as dest_ip
FIELDALIAS-src_ip_for_checkpoint = src as src_ip
FIELDALIAS-dest_port_for_checkpoint = dpt AS dest_port
FIELDALIAS-src_port_for_checkpoint = spt AS src_port
FIELDALIAS-vendor_action = act as vendor_action
FIELDALIAS-vendor = cef_vendor as vendor
FIELDALIAS-product = cef_product as product
EVAL-dvc = coalesce(dvchost,dvc)
EVAL-transport = lower(proto)
EVAL-vendor_product = cef_vendor." ".cef_product

# Bytes transferred
FIELDALIAS-in = in as bytes_in
FIELDALIAS-out = out as bytes_out
EVAL-bytes = if(cs5Label=="Total bytes",cs5,null)

REPORT-s_user_for_checkpoint_arcsight_cef = suser_as_user_for_checkpoint_arcsight_cef

# get the action for Checkpoint ArcSight CEF
LOOKUP-action_for_checkpoint_syslog = checkpoint_arcsight_cef_action_lookup vendor_action OUTPUT action
LOOKUP-severity_for_checkpoint_syslog = checkpoint_arcsight_cef_severity_lookup deviceSeverity OUTPUT severity

####
#### Checkpoint ArcSight URL Filtering specific extractions
####
FIELDALIAS-url = request as url
REPORT-site_for_checkpoint_arcsight_cef = site_from_request_for_checkpoint_arcsight_cef
EVAL-dest = coalesce(site,dhost,dst)
FIELDALIAS-category = ad_matched__category as category

#####################################################
# Checkpoint App Control from ArcSight
#####################################################
[checkpoint:arcsight:cef:appcontrol]
# disable auto KV
KV_MODE = none

# CEF extractions for Checkpoint events
REPORT-00checkpoint_cefHeaders = checkpoint_arcsight_cefHeaders
REPORT-00checkpoint_cefKeys = checkpoint_arcsight_cefKeys
####
#### CIM field mappings common for Checkpoint CEF
####
FIELDALIAS-dest_ip_for_checkpoint = dst as dest_ip
FIELDALIAS-src_ip_for_checkpoint = src as src_ip
FIELDALIAS-dest_port_for_checkpoint = dpt AS dest_port
FIELDALIAS-src_port_for_checkpoint = spt AS src_port
FIELDALIAS-vendor_action = act as vendor_action
FIELDALIAS-vendor = cef_vendor as vendor
FIELDALIAS-product = cef_product as product
EVAL-dvc = coalesce(dvchost,dvc)
EVAL-transport = lower(proto)
EVAL-vendor_product = cef_vendor." ".cef_product

# Bytes transferred
FIELDALIAS-in = in as bytes_in
FIELDALIAS-out = out as bytes_out
EVAL-bytes = if(cs5Label=="Total bytes",cs5,null)

REPORT-user_for_checkpoint_arcsight_cef = duser_as_user_for_checkpoint_arcsight_cef

# get the action for Checkpoint ArcSight CEF
LOOKUP-action_for_checkpoint_syslog = checkpoint_arcsight_cef_action_lookup vendor_action OUTPUT action
LOOKUP-severity_for_checkpoint_syslog = checkpoint_arcsight_cef_severity_lookup deviceSeverity OUTPUT severity

####
#### Checkpoint ArcSight Application Control specific extractions
####
EVAL-dest = coalesce(dhost,dst)
FIELDALIAS-app_for_cp = ad_appi__name as app
FIELDALIAS-rule = cs6 as rule

#####################################################
# Checkpoint ID Awareness from ArcSight
#####################################################
[checkpoint:arcsight:cef:identity]
# disable auto KV
KV_MODE = none

# CEF extractions for Checkpoint events
REPORT-00checkpoint_cefHeaders = checkpoint_arcsight_cefHeaders
REPORT-00checkpoint_cefKeys = checkpoint_arcsight_cefKeys

####
#### CIM field mappings common for Checkpoint CEF
####
FIELDALIAS-dest_ip_for_checkpoint = dst as dest_ip
FIELDALIAS-src_ip_for_checkpoint = src as src_ip
FIELDALIAS-dest_port_for_checkpoint = dpt AS dest_port
FIELDALIAS-src_port_for_checkpoint = spt AS src_port
FIELDALIAS-vendor_action = act as vendor_action
FIELDALIAS-vendor = cef_vendor as vendor
FIELDALIAS-product = cef_product as product
EVAL-dvc = coalesce(dvchost,dvc)
EVAL-transport = lower(proto)
EVAL-vendor_product = cef_vendor." ".cef_product

# Bytes transferred
FIELDALIAS-in = in as bytes_in
FIELDALIAS-out = out as bytes_out
EVAL-bytes = if(cs5Label=="Total bytes",cs5,null)

REPORT-user_for_checkpoint_arcsight_cef = duser_as_user_for_checkpoint_arcsight_cef

# get the action for Checkpoint ArcSight CEF
LOOKUP-action_for_checkpoint_syslog = checkpoint_arcsight_cef_action_lookup vendor_action OUTPUT action
LOOKUP-severity_for_checkpoint_syslog = checkpoint_arcsight_cef_severity_lookup deviceSeverity OUTPUT severity

#####################################################
# Checkpoint Anti Virus from ArcSight
#####################################################
[checkpoint:arcsight:cef:antivirus]
# disable auto KV
KV_MODE = none

# CEF extractions for Checkpoint events
REPORT-00checkpoint_cefHeaders = checkpoint_arcsight_cefHeaders
REPORT-00checkpoint_cefKeys = checkpoint_arcsight_cefKeys

####
#### CIM field mappings common for Checkpoint CEF
####
FIELDALIAS-dest_ip_for_checkpoint = dst as dest_ip
FIELDALIAS-src_ip_for_checkpoint = src as src_ip
FIELDALIAS-dest_port_for_checkpoint = dpt AS dest_port
FIELDALIAS-src_port_for_checkpoint = spt AS src_port
FIELDALIAS-vendor_action = act as vendor_action
FIELDALIAS-vendor = cef_vendor as vendor
FIELDALIAS-product = cef_product as product
EVAL-dvc = coalesce(dvchost,dvc)
EVAL-transport = lower(proto)
EVAL-vendor_product = cef_vendor." ".cef_product

# Bytes transferred
FIELDALIAS-in = in as bytes_in
FIELDALIAS-out = out as bytes_out
EVAL-bytes = if(cs5Label=="Total bytes",cs5,null)

REPORT-user_for_checkpoint_arcsight_cef = duser_as_user_for_checkpoint_arcsight_cef

# get the action for Checkpoint ArcSight CEF
LOOKUP-action_for_checkpoint_syslog = checkpoint_arcsight_cef_action_lookup vendor_action OUTPUT action
LOOKUP-severity_for_checkpoint_syslog = checkpoint_arcsight_cef_severity_lookup deviceSeverity OUTPUT severity

####
#### Checkpoint ArcSight Anti Virus specific extractions
####
FIELDALIAS-url = request as url
REPORT-site_for_checkpoint_arcsight_cef = site_from_request_for_checkpoint_arcsight_cef
REPORT-signature_for_checkpoint_arcsight_cef_malware = signature_for_checkpoint_arcsight_cef_malware

FIELDALIAS-file_name = fname as file_name
FIELDALIAS-file_hash = ad_file__md5 as file_hash
FIELDALIAS-category = ad_malware__family as category

#####################################################
# Checkpoint Anti Malware from ArcSight
#####################################################
[checkpoint:arcsight:cef:antimalware]
# disable auto KV
KV_MODE = none

# CEF extractions for Checkpoint events
REPORT-00checkpoint_cefHeaders = checkpoint_arcsight_cefHeaders
REPORT-00checkpoint_cefKeys = checkpoint_arcsight_cefKeys
####
#### CIM field mappings common for Checkpoint CEF
####
FIELDALIAS-dest_ip_for_checkpoint = dst as dest_ip
FIELDALIAS-src_ip_for_checkpoint = src as src_ip
FIELDALIAS-dest_port_for_checkpoint = dpt AS dest_port
FIELDALIAS-src_port_for_checkpoint = spt AS src_port
FIELDALIAS-vendor_action = act as vendor_action
FIELDALIAS-vendor = cef_vendor as vendor
FIELDALIAS-product = cef_product as product
EVAL-dvc = coalesce(dvchost,dvc)
EVAL-transport = lower(proto)
EVAL-vendor_product = cef_vendor." ".cef_product

# Bytes transferred
FIELDALIAS-in = in as bytes_in
FIELDALIAS-out = out as bytes_out
EVAL-bytes = if(cs5Label=="Total bytes",cs5,null)

REPORT-user_for_checkpoint_arcsight_cef = duser_as_user_for_checkpoint_arcsight_cef

# get the action for Checkpoint ArcSight CEF
LOOKUP-action_for_checkpoint_syslog = checkpoint_arcsight_cef_action_lookup vendor_action OUTPUT action
LOOKUP-severity_for_checkpoint_syslog = checkpoint_arcsight_cef_severity_lookup deviceSeverity OUTPUT severity

####
#### Checkpoint ArcSight Anti-Malware specific extractions
####
FIELDALIAS-url = request as url
REPORT-site_for_checkpoint_arcsight_cef = site_from_request_for_checkpoint_arcsight_cef
REPORT-signature_for_checkpoint_arcsight_cef_malware = signature_for_checkpoint_arcsight_cef_malware

FIELDALIAS-category = ad_malware__family as category
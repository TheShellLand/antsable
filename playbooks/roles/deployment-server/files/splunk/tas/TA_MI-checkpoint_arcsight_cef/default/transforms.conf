# Sourcetype renaming transforms stanzas
[sourcetype_for_checkpoint_arcsight_cef_firewall]
REGEX = CEF\:0\|Check\sPoint\|VPN\-1\s&\sFireWall\-1
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::checkpoint:arcsight:cef:firewall

[sourcetype_for_checkpoint_arcsight_cef_smartdefense]
REGEX = CEF\:0\|Check\sPoint\|SmartDefense
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::checkpoint:arcsight:cef:smartdefense

[sourcetype_for_checkpoint_arcsight_cef_urlfiltering]
REGEX = CEF\:0\|Check\sPoint\|URL\sFiltering
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::checkpoint:arcsight:cef:url

[sourcetype_for_checkpoint_arcsight_cef_appcontrol]
REGEX = CEF\:0\|Check\sPoint\|Application\sControl
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::checkpoint:arcsight:cef:appcontrol

[sourcetype_for_checkpoint_arcsight_cef_identity]
REGEX = CEF\:0\|Check\sPoint\|Identity\sAwareness
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::checkpoint:arcsight:cef:identity

[sourcetype_for_checkpoint_arcsight_cef_antivirus]
REGEX = CEF\:0\|Check\sPoint\|New\sAnti\sVirus
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::checkpoint:arcsight:cef:antivirus

[sourcetype_for_checkpoint_arcsight_cef_antimalware]
REGEX = CEF\:0\|Check\sPoint\|Anti\sMalware
DEST_KEY = MetaData:Sourcetype
FORMAT = sourcetype::checkpoint:arcsight:cef:antimalware

# Generic CEF extractions

[checkpoint_arcsight_cefHeaders]
REGEX = CEF:(?<cef_cefVersion>\d+)\|(?<cef_vendor>[^|]*)\|(?<cef_product>[^|]*)\|(?<cef_version>[^|]*)\|(?<cef_signature>[^|]*)\|(?<cef_name>[^|]*)\|(?<cef_severity>[^|]*)

[checkpoint_arcsight_cefKeys]
REGEX = (?:_+)?(?<_KEY_1>[\w.:\[\]]+)=(?<_VAL_1>.*?(?=(?:\s[\w.:\[\]]+=|$)))
REPEAT_MATCH = TRUE
CLEAN_KEYS = 1

# CIM extractions
# Change duser to suser

[suser_as_user_for_checkpoint_arcsight_cef]
REGEX = (?:\(|^)(?<user>[^\(\)]+)\)?$
SOURCE_KEY = suser

[duser_as_user_for_checkpoint_arcsight_cef]
REGEX = (?:\(|^)(?<user>[^\(\)]+)\)?$
SOURCE_KEY = duser

[site_from_request_for_checkpoint_arcsight_cef]
REGEX = :/+(?<site>[^:/]*)
SOURCE_KEY = request

[signature_for_checkpoint_arcsight_cef_malware]
REGEX = Protection_,name=(?<signature>[^\s]*)
SOURCE_KEY = ad_has__accounting

# Lookups

[checkpoint_arcsight_cef_action_lookup]
filename = checkpoint_arcsight_cef_actions.csv

[checkpoint_arcsight_cef_severity_lookup]
filename = checkpoint_arcsight_cef_severity.csv
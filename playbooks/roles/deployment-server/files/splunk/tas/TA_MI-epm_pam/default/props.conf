#Thycotic PAM sourcetype
[pam:syslog]
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 5000
TIME_PREFIX = \srt\=
TIME_FORMAT = %b %d %Y %T
MAX_TIMESTAMP_LOOKAHEAD = 20 
KV_MODE = none
SHOULD_LINEMERGE = false
#EXTRACT-all = ^(?:[^\|]*\|){4}(?P<EventID>[^\|]+)| (Action\: (?P<change_type>\[[^:\]]+]) )|(By User\: (?P<by_user>([^:=](?!Item Name:))+) )|(Container Name\: (?P<container_name>[^:=]+(?!suid=)) )|(Details\: (?P<details>[^:]+) (suid=\d))|(Event\: (?P<event>[^:]+) )|(fileId=(?P<file_id>[^=]+) )| (fname=(?P<file_name>[^=]+) )|(fileType=(?P<file_type>[^=]+) )|(Item Name\: (?P<item_name>[^:=]+(?!suid\=)) )|^([^|]+\|){6}(?P<severity>[^|]+)|^([^|]+\|){5}(?P<message_name>[^|]+)|^(?P<preamble>[^|]+)\||^([^|]+\|){2}(?P<product>[^|]+)|(rt=(?P<receipt_time>[^=]+) )|(cs1=(?P<cs1>[^=]+) )|(cs1Label=(?P<cs1Label>[^=]+) )|(cs2=(?P<cs2>[^=]+) )|(cs2Label=(?P<cs2Label>[^=]+) )|(cs3Label=(?P<cs3Label>[^=]+) )|(cs4=(?P<cs4>[^=]+) )| (cs4Label=(?P<cs4Label>[^=]+) ) | (msg=(?P<msg>[^=]+) )| ^([^|]+\|){4}(?P<tss_signature_id>[^|]+)|(src=(?P<tss_src>[^=]+) )|(suid=(?P<tss_suid>[^=]+) )|(suser=(?P<tss_suser>[^=]+) )|^([^|]+\|){1}(?P<vendor>[^|]+)|^([^|]+\|){3}(?P<version>[^|]+)

EXTRACT-cef-message = \sCEF:\d\|(?<vendor>[^\|]+)\|(?<product>[^\|]+)\|(?<version>[^\|]+)\|(?<signature_id>[^\|]+)\|(?<signature>[^\|]+)\|(?<vendor_severity>[^\|]+)\|(?<cef_message>.*)
REPORT-parse_cef = cef_auto_kv,cef_first,cef_last

#host overriding
TRANSFORMS-host_pam=host_pam_override

pulldown_type = 1
BREAK_ONLY_BEFORE_DATE = 
DATETIME_CONFIG = 
NO_BINARY_CHECK = true
disabled = false

#Thycotic EPM sourcetype
[epm:syslog]
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 5000
TIME_PREFIX = ^<\d>\d\s
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%6N%:z
MAX_TIMESTAMP_LOOKAHEAD = 40
KV_MODE = none
SHOULD_LINEMERGE = false
#EXTRACT-all = ^(?:[^\|]*\|){4}(?P<EventID>[^\|]+)| (Action\: (?P<change_type>\[[^:\]]+]) )|(By User\: (?P<by_user>([^:=](?!Item Name:))+) )|(Container Name\: (?P<container_name>[^:=]+(?!suid=)) )|(Details\: (?P<details>[^:]+) (suid=\d))|(Event\: (?P<event>[^:]+) )|(fileId=(?P<file_id>[^=]+) )| (fname=(?P<file_name>[^=]+) )|(fileType=(?P<file_type>[^=]+) )|(Item Name\: (?P<item_name>[^:=]+(?!suid\=)) )|^([^|]+\|){6}(?P<severity>[^|]+)|^([^|]+\|){5}(?P<message_name>[^|]+)|^(?P<preamble>[^|]+)\||^([^|]+\|){2}(?P<product>[^|]+)|(rt=(?P<receipt_time>[^=]+) )|(cs1=(?P<cs1>[^=]+) )|(cs1Label=(?P<cs1Label>[^=]+) )|(cs2=(?P<cs2>[^=]+) )|(cs2Label=(?P<cs2Label>[^=]+) )|(cs3Label=(?P<cs3Label>[^=]+) )|(cs4=(?P<cs4>[^=]+) )| (cs4Label=(?P<cs4Label>[^=]+) ) | (msg=(?P<msg>[^=]+) )| ^([^|]+\|){4}(?P<tss_signature_id>[^|]+)|(src=(?P<tss_src>[^=]+) )|(suid=(?P<tss_suid>[^=]+) )|(suser=(?P<tss_suser>[^=]+) )|^([^|]+\|){1}(?P<vendor>[^|]+)|^([^|]+\|){3}(?P<version>[^|]+)

EXTRACT-cef-message = \sCEF:\d\|(?<vendor>[^\|]+)\|(?<product>[^\|]+)\|(?<version>[^\|]+)\|(?<signature_id>[^\|]+)\|(?<signature>[^\|]+)\|(?<vendor_severity>[^\|]+)\|(?<cef_message>.*)
REPORT-parse_cef = cef_auto_kv,cef_first,cef_last
pulldown_type = 1
BREAK_ONLY_BEFORE_DATE =
DATETIME_CONFIG =
NO_BINARY_CHECK = true
disabled = false

#removing syslog severity
SEDCMD-syslogheader = s/^\<\d\>\d\s//g

#host overriding
TRANSFORMS-host_epm=host_epm_override



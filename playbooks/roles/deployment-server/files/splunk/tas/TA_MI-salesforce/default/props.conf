#####################################
###         Internal Logs         ###
#####################################
[source::...(/|\\)var(/|\\)log(/|\\)splunk(/|\\)*splunk_ta_salesforce_sfdc_object*.log*]
SHOULD_LINEMERGE = false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}
sourcetype = sfdc:object:log
priority = 1

[source::...(/|\\)var(/|\\)log(/|\\)splunk(/|\\)*splunk_ta_salesforce_sfdc_event_log*.log*]
SHOULD_LINEMERGE = false
LINE_BREAKER=([\r\n]+)\d{4}-\d{2}-\d{2}
sourcetype = sfdc:eventlog:log
priority = 1


#####################################
###         Event Log             ###
#####################################
[sfdc:logfile]
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
category = Splunk App Add-on Builder
TZ = UTC

EVAL-app = "sfdc"
EVAL-vendor_product = "sfdc"
EVAL-action = case(HTTP_METHOD="GET" or HTTP_METHOD="HEAD", "read", HTTP_METHOD="POST", "created", HTTP_METHOD="PUT" or HTTP_METHOD="PATCH", "modified", HTTP_METHOD="DELETE", "deleted", METHOD="GET" or METHOD="HEAD", "read", METHOD="POST", "created", METHOD="PUT" or METHOD="PATCH", "modified", METHOD="DELETE", "deleted", like(METHOD_NAME, "%insert%"), "created", like(METHOD_NAME, "%update%"), "modified", like(METHOD_NAME, "%delete%"), "deleted", like(METHOD_NAME, "%query%"), "read", like(METHOD_NAME, "%retrieve%"), "read", like(METHOD_NAME, "%get%"), "read", 1==1, "unknown")
EVAL-result = case(REQUEST_STATUS=="S", "Success", REQUEST_STATUS=="A", "Authorization Error", REQUEST_STATUS=="R", "Redirect", REQUEST_STATUS=="N", "Not Found", REQUEST_STATUS=="F", "Failure", REQUEST_STATUS=="U", "Undefined", 1==1, "unknown")
EVAL-status = case(EVENT_TYPE="API" AND REQUEST_STATUS=="S", "success", EVENT_TYPE="API" AND isnotnull(REQUEST_STATUS), "failure", EVENT_TYPE="API", "unknown", REQUEST_STATUS=="S", 200, REQUEST_STATUS=="A", 401, REQUEST_STATUS=="R", 302, REQUEST_STATUS=="N", 404, 1==1, "unknown")
EVAL-bytes_in = if(REQUEST_SIZE=="-1", 0, REQUEST_SIZE)
EVAL-bytes = if(REQUEST_SIZE=="-1", RESPONSE_SIZE, REQUEST_SIZE+RESPONSE_SIZE)
EVAL-http_method = if(isnotnull(HTTP_METHOD), HTTP_METHOD, METHOD)
EXTRACT-URL = \"\"?(?<URL>.*?)\"?\"\s

FIELDALIAS-bytes_out = RESPONSE_SIZE AS bytes_out
FIELDALIAS-command = QUERY AS command
FIELDALIAS-dest = URI AS dest
FIELDALIAS-duration = RUN_TIME as duration
FIELDALIAS-object = ENTITY_NAME AS object
FIELDALIAS-src = CLIENT_IP AS src
FIELDALIAS-uri_path = URI AS uri_path
FIELDALIAS-uri_query = QUERY AS uri_query
FIELDALIAS-url = URI AS url

LOOKUP-SFDC-USER_NAME1 = lookup_sfdc_usernames USER_ID AS USER_ID OUTPUTNEW UserId FirstName City AS profile_city Country as profile_country IsActive LastLoginDate LastName MobilePhone Name PostalCode State Username UserRoleId UserType Email Email as user CompanyName ProfileId Profile.PermissionsApiEnabled Profile.PermissionsModifyAllData Profile.PermissionsViewSetup
LOOKUP-SFDC-USER_AGENT = lookup_sfdc_user_agent USER_AGENT OUTPUTNEW http_user_agent


#####################################
###           Objects             ###
#####################################
[sfdc:dashboard]
DATETIME_CONFIG = NONE
MAX_TIMESTAMP_LOOKAHEAD = 0
category = Splunk App Add-on Builder
TZ = UTC


[sfdc:user]
DATETIME_CONFIG = NONE
MAX_TIMESTAMP_LOOKAHEAD = 0
category = Splunk App Add-on Builder
TZ = UTC


[sfdc:account]
DATETIME_CONFIG = NONE
MAX_TIMESTAMP_LOOKAHEAD = 0
category = Splunk App Add-on Builder
TZ = UTC


[sfdc:object]
DATETIME_CONFIG = NONE
MAX_TIMESTAMP_LOOKAHEAD = 0
category = Splunk App Add-on Builder
TZ = UTC


[sfdc:opportunity]
DATETIME_CONFIG = NONE
MAX_TIMESTAMP_LOOKAHEAD = 0
category = Splunk App Add-on Builder
TZ = UTC


[sfdc:loginhistory]
DATETIME_CONFIG = NONE
MAX_TIMESTAMP_LOOKAHEAD = 0
category = Splunk App Add-on Builder
TZ = UTC

EVAL-action = if(Status=="Success", "success", "failure")
EVAL-app = if(Application=="N/A", "sfdc:unknown", "sfdc:".Application)
FIELDALIAS-dest = LoginUrl AS dest
FIELDALIAS-dest_host = LoginUrl AS dest_host
FIELDALIAS-signature_id = Id AS signature_id
FIELDALIAS-src = SourceIp AS src

LOOKUP-SFDC-USER_NAME = lookup_sfdc_usernames UserId AS UserId OUTPUTNEW UserId FirstName City AS profile_city Country as profile_country IsActive LastLoginDate LastName MobilePhone Name PostalCode State Username UserRoleId UserType UserType as user_category Email Email as user CompanyName ProfileId Profile.PermissionsApiEnabled Profile.PermissionsModifyAllData Profile.PermissionsViewSetup


[sfdc:report]
DATETIME_CONFIG = NONE
MAX_TIMESTAMP_LOOKAHEAD = 0
category = Splunk App Add-on Builder
TZ = UTC

[sfdc:contentversion]
DATETIME_CONFIG = NONE
MAX_TIMESTAMP_LOOKAHEAD = 0
category = Splunk App Add-on Builder
TZ = UTC

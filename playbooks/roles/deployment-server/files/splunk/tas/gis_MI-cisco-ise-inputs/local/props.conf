
[cisco:ise]
rename=cisco:ise:syslog
SHOULD_LINEMERGE = false
DATETIME_CONFIG = /etc/apps/Splunk_TA_cisco-ise/default/datetime_udp.xml
TIME_PREFIX = \d\s\d\s
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%3N %Z


[cisco:ise:syslog]
SHOULD_LINEMERGE = false
DATETIME_CONFIG = /etc/apps/Splunk_TA_cisco-ise/default/datetime_udp.xml
TIME_PREFIX = \d\s\d\s
TIME_FORMAT = %Y-%m-%d %H:%M:%S.%3N %Z

# Extractions
EXTRACT-Message Code = \d+\s(?<MESSAGE_CODE>\d+)\s(NOTICE|WARN|INFO|DEBUG|ERROR|FATAL)\s
EXTRACT-provisioning = Client\sProvisioning:\s+Client\sprovisioning\s(?<provisioning_action>\w+)

# Reports
REPORT-cisco-ise-fields = cisco-ise-type, cisco-ise-vendor-action, cisco-ise-servername
REPORT-cisco-ise-fieldsTwo = cisco-ise-alarm, cisco-ise-alarm-type, cisco-ise-performance
REPORT-cisco-ise-fieldsThree = cisco-ise-system-mgmt-desc, cisco-ise-cisco-av-pair
REPORT-cisco-ise-fieldsFour = cisco-ise-tunnel-private-group-id
REPORT-cisco-ise-action-action-FAIL = cisco-ise-action-failure-for-auth
REPORT-cisco-ise-action-great-success = cisco-ise-action-success-for-auth
REPORT-cisco-ise-action-blocked = cisco-ise-action-blocked
REPORT-cisco-ise-action-allowed = cisco-ise-action-allowed
REPORT-cisco-ise-action-unknown = cisco-ise-action-unknown
REPORT-cisco-ise-field-action = cisco_ise_field_action, cisco-ise-vendor-action-for-auth

# Aliases
FIELDALIAS-cisco-ise-address-as-src_ip = Address AS src_ip
FIELDALIAS-cisco-ise-address-as-src = Address AS src
FIELDALIAS-cisco-ise-destinationipaddress-as-dest_ip = DestinationIPAddress AS dest_ip
FIELDALIAS-cisco-ise-destinationipaddress-as-dest = DestinationIPAddress AS dest
FIELDALIAS-cisco-ise-user_name-as-UserName = User_Name AS UserName
FIELDALIAS-cisco-ise-cim-ip = Framed_IP_Address AS src_ip IpAddress AS src_ip
FIELDALIAS-cisco-ise-src_int = NAS_Port_Id AS src_int
FIELDALIAS-cisco-ise-destinationport-as-dest-port = DestinationPort AS dest_port
FIELDALIAS-cisco-ise-username-as-user = UserName AS user
FIELDALIAS-cisco-ise-vendor-action = log_type AS vendor_action
FIELDALIAS-cisco-ise-session-id = AcsSessionID AS session_id SessionId AS session_id

# Evals
EVAL-vendor = "Cisco"
EVAL-product = if(server_type == "CISE", "Identity Services Engine", "Secure Access Control System")
EVAL-app = if(server_type == "CISE", "ISE", "ACS")
EVAL-action = case(match(provisioning_action,"(?i)succeeded"),"created",MESSAGE_CODE=5400,"failure",MESSAGE_CODE=5200,"success",1=1,action)

EVAL-src_mac = replace(replace(coalesce(Calling_Station_ID,MacAddress,src_mac),"([^:]+)(:.*)","\1"),"-",":")
EVAL-dest_mac = replace(replace(coalesce(Called_Station_ID,dest_mac),"([^:]+)(:.*)","\1"),"-",":")

# Lookups
LOOKUP-cisco-ise-message-catalog = cisco-ise-message-catalog-lookup MESSAGE_CODE OUTPUT MESSAGE_CLASS, MESSAGE_TEXT


[syslog]
TRANSFORMS-cisco-ise = cisco-ise-sourcetyper


[Cisco:ISE:Syslog]
rename = cisco:ise:syslog

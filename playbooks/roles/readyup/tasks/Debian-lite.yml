---
- set_fact:
    install: /tmp/readyup

- name: temp install
  file: path={{ install }} state=directory

- name: Update cache
  apt: update_cache=yes
  become: yes
  changed_when: false

- name: Install Missing Packages
  shell: apt install -f -y
  register: shell
  changed_when: '"Installing: 0" not in shell.stdout'
  become: yes

- include_role: name=git
- include_role: name=gcc
- include_role: name=curl
- include_role: name=rsync
- include_role: name=pass
- include_role: name=rclone
- include_role: name=tmux

- include_role:
    name: apt-installer
  vars:
    package: xorg

- include_role:
    name: apt-installer
  vars:
    package: openbox

- include_role:
    name: apt-installer
  vars:
    package: software-properties-common

- include_role:
    name: apt-installer
  vars:
    package: sudo

- include_role:
    name: apt-installer
  vars:
    package: make

- include_role:
    name: apt-installer
  vars:
    package: perl

- include_role:
    name: apt-installer
  vars:
    package: unzip

- include_role:
    name: apt-installer
  vars:
    package: chrome-gnome-shell

- include_role:
    name: apt-installer
  vars:
    package: cifs-utils

- include_role:
    name: apt-installer
  vars:
    package: sshfs

# gnome-backup duplicity
- include_role:
    name: apt-installer
  vars:
    package: duplicity

- include_role:
    name: apt-installer
  vars:
    package: cryptsetup

- include_role:
    name: apt-installer
  vars:
    package: python3-pip

- include_role:
    name: apt-installer
  vars:
    package: python3-distutils

- include_role:
    name: apt-installer
  vars:
    package: virt-viewer

- include_role:
    name: apt-installer
  vars:
    package: x11vnc

- include_role:
    name: apt-installer
  vars:
    package: x2goclient

- include_role:
    name: apt-installer
  vars:
    package: remmina

- include_role:
    name: apt-installer
  vars:
    package: exfat-fuse

- include_role:
    name: apt-installer
  vars:
    package: vlc

- include_role:
    name: apt-installer
  vars:
    package: vim

- include_role:
    name: apt-installer
  vars:
    package: wireshark

- include_role:
    name: apt-installer
  vars:
    package: darktable

- include_role:
    name: apt-installer
  vars:
    package: gimp

- include_role:
    name: apt-installer
  vars:
    package: audacity

- name: Pycharm
  snap:
    name: pycharm
    classic: yes
    state: present
    channel: 2025.2.1.1/stable
  become: yes
  changed_when: false

- block:
  - name: Chrome
    apt:
      deb: https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
    become: yes
    changed_when: false
#  - name: Chrome beta
#    apt:
#      deb: https://dl.google.com/linux/direct/google-chrome-beta_current_amd64.deb
#    ignore_errors: yes
#  - name: Chrome dev
#    apt:
#      deb: https://dl.google.com/linux/direct/google-chrome-unstable_current_amd64.deb
#    ignore_errors: yes
  - name: Install missing dependencies
    shell: apt install -f -y
    become: yes
    changed_when: false

  rescue:
  - include_role:
      name: apt-installer
    vars:
      package: chromium-browser

- name: Visual Studio Code
  snap:
    name: code-insiders
    classic: yes
    state: present
  become: yes
  changed_when: false

- name: Peek screen recorder
  apt:
    deb: https://github.com/phw/peek/releases/download/v0.8.0/peek-0.8.0-Linux.deb
  ignore_errors: yes
  become: yes
  changed_when: false

- name: autoclean
  apt:
    autoclean: yes
  become: yes
  changed_when: false

- name: autoremove
  apt:
    autoremove: yes
  become: yes
  changed_when: false

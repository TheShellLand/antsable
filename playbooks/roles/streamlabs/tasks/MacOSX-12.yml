---
- set_fact:
    version: 1.5.0

- get_url:
    url: https://slobs-cdn.streamlabs.com/Streamlabs+OBS-1.5.0.dmg
    dest: ./streamlabs.dmg

- shell: |
    url=streamlabs.dmg

    folder="Streamlabs OBS {{ version }}"
    app="Streamlabs OBS.app"

    hdiutil attach -nobrowse "$url"
    volume="/Volumes/$folder"
    cp -R "$volume/$app" /Applications/ && echo OK
    hdiutil detach "$volume"
  register: shell
  become: yes
  changed_when: "'OK' not in shell.stdout"